<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_22) on Mon Sep 23 12:49:46 EDT 2013 -->
<TITLE>
WindowsCommandShellService (Agent Manager Developer's Kit)
</TITLE>

<META NAME="date" CONTENT="2013-09-23">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="WindowsCommandShellService (Agent Manager Developer's Kit)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>Foglight Agent Manager<br/>Developer's Kit</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/quest/glue/api/services/WindowsConnectionRefusedException.html" title="class in com.quest.glue.api.services"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/quest/glue/api/services/WindowsCommandShellService.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="WindowsCommandShellService.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.quest.glue.api.services</FONT>
<BR>
Interface WindowsCommandShellService</H2>
<DL>
<DT><B>All Superinterfaces:</B> <DD><A HREF="../../../../../com/quest/glue/api/services/Service.html" title="interface in com.quest.glue.api.services">Service</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>WindowsCommandShellService</B><DT>extends <A HREF="../../../../../com/quest/glue/api/services/Service.html" title="interface in com.quest.glue.api.services">Service</A></DL>
</PRE>

<P>
A service used to establish a connection to a Windows command shell to execute various commands.
 </p>
 The <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html" title="interface in com.quest.glue.api.services"><CODE>WindowsCommandShellService</CODE></A> is meant to be used instead of the deprecated <CODE>WindowsShellService</CODE>. However,
 the file transfer functionality has not yet been replaced, so if this functionality is required the <CODE>WindowsShellService</CODE>
 should still be used.
<P>

<P>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#addConnectionTest(java.lang.String, java.util.List, com.quest.glue.api.services.ConnectionTestCallback)">addConnectionTest</A></B>(java.lang.String&nbsp;scheme,
                  java.util.List&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt;&nbsp;params,
                  <A HREF="../../../../../com/quest/glue/api/services/ConnectionTestCallback.html" title="interface in com.quest.glue.api.services">ConnectionTestCallback</A>&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A>&gt;&nbsp;callback)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a new connection test.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#establish(com.quest.glue.api.services.CredentialQuery2, java.util.List)">establish</A></B>(<A HREF="../../../../../com/quest/glue/api/services/CredentialQuery2.html" title="interface in com.quest.glue.api.services">CredentialQuery2</A>&nbsp;query,
          java.util.List&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt;&nbsp;params)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try establishing a connection to a Windows command shell using any of the provided connection configurations.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" SUMMARY="">
<TR ALIGN="right" VALIGN="">
<TD NOWRAP><FONT SIZE="-1">
<CODE>&lt;T extends <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt; 
<BR>
T</CODE></FONT></TD>
</TR>
</TABLE>
</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#newConnectionParameters(java.lang.Class)">newConnectionParameters</A></B>(java.lang.Class&lt;T&gt;&nbsp;parametersClass)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factory method used to create a FglAM-backed concrete instance of <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services"><CODE>WindowsCommandShellParameters</CODE></A> for
 use in <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#establish(com.quest.glue.api.services.CredentialQuery2, java.util.List)"><CODE>establish(CredentialQuery2, java.util.List)</CODE></A> calls.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#release(com.quest.glue.api.services.WindowsCommandShell)">release</A></B>(<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A>&nbsp;shell)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Releases the shell connection once it is no longer required.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="addConnectionTest(java.lang.String, java.util.List, com.quest.glue.api.services.ConnectionTestCallback)"><!-- --></A><H3>
addConnectionTest</H3>
<PRE>
void <B>addConnectionTest</B>(java.lang.String&nbsp;scheme,
                       java.util.List&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt;&nbsp;params,
                       <A HREF="../../../../../com/quest/glue/api/services/ConnectionTestCallback.html" title="interface in com.quest.glue.api.services">ConnectionTestCallback</A>&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A>&gt;&nbsp;callback)</PRE>
<DL>
<DD>Adds a new connection test.  When requested by users this callback will be invoked with a successfully established
 connection created using one of the provided <code>params</code>.  If the callback is successfully executed FglAM
 will assume the test passed and a successful result will be returned to the user.
 <p/>
 If no tests cannot be executed because a connection could not be established, or all of the invoked callbacks fail,
 then a failure result will be returned to the user.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>scheme</CODE> - The URI scheme to be associated with this validator. See <CODE>URI.getScheme()</CODE> for value specifications.<DD><CODE>params</CODE> - Parameters that describe how the connections should be established<DD><CODE>callback</CODE> - An agent-specific callback that will be invoked when a test connection has been established</DL>
</DD>
</DL>
<HR>

<A NAME="establish(com.quest.glue.api.services.CredentialQuery2, java.util.List)"><!-- --></A><H3>
establish</H3>
<PRE>
<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A> <B>establish</B>(<A HREF="../../../../../com/quest/glue/api/services/CredentialQuery2.html" title="interface in com.quest.glue.api.services">CredentialQuery2</A>&nbsp;query,
                              java.util.List&lt;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt;&nbsp;params)
                              throws <A HREF="../../../../../com/quest/glue/api/services/ConnectionCancelledException.html" title="class in com.quest.glue.api.services">ConnectionCancelledException</A>,
                                     <A HREF="../../../../../com/quest/glue/api/services/RemoteConnectionException.html" title="class in com.quest.glue.api.services">RemoteConnectionException</A>,
                                     java.lang.InterruptedException</PRE>
<DL>
<DD>Try establishing a connection to a Windows command shell using any of the provided connection configurations.  This service
 will try each of the provided connections in order until a connection is established.  If no connections are made
 using any of the provided parameters then a RemoteConnectionException will be thrown up to the agent.
 <p/>
 A connection can be attempted with multiple parameters, making it impossible for FglAM to throw detailed exceptions
 to the agent describing which connections have failed and which have not.  Instead, events will be reported to the
 FMS on a per-attempt basis.
 <p/>
 Connection parameters can be obtained from the <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#newConnectionParameters(java.lang.Class)"><CODE>newConnectionParameters(java.lang.Class<T>)</CODE></A> function. Modifiable <code>params</code>
 collections allow FglAM to perform an in-place rotation of the collection when an attempt at using a parameter has failed.
 Maintaining this list between invocations allows FglAM to begin subsequent connection attempts using the last good parameter,
 meaning connections to be made without repeatedly failing every time the agent collects data.  Read-only collections are
 acceptable but will not benefit from in-place modification.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>query</CODE> - A query used to find credentials will be used to establish new connections<DD><CODE>params</CODE> - Parameters that describe how a connection should be established
<DT><B>Returns:</B><DD>A successfully established connection to the remote system
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/quest/glue/api/services/ConnectionCancelledException.html" title="class in com.quest.glue.api.services">ConnectionCancelledException</A></CODE> - The connection attempt was purposely cancelled
<DD><CODE><A HREF="../../../../../com/quest/glue/api/services/RemoteConnectionException.html" title="class in com.quest.glue.api.services">RemoteConnectionException</A></CODE> - A connection could not be established with <strong>any</strong> of the parameters
<DD><CODE>java.lang.InterruptedException</CODE> - This thread was interrupted before a connection could be established</DL>
</DD>
</DL>
<HR>

<A NAME="newConnectionParameters(java.lang.Class)"><!-- --></A><H3>
newConnectionParameters</H3>
<PRE>
&lt;T extends <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services">WindowsCommandShellParameters</A>&gt; T <B>newConnectionParameters</B>(java.lang.Class&lt;T&gt;&nbsp;parametersClass)
                                                                throws java.lang.IllegalArgumentException</PRE>
<DL>
<DD>Factory method used to create a FglAM-backed concrete instance of <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services"><CODE>WindowsCommandShellParameters</CODE></A> for
 use in <A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellService.html#establish(com.quest.glue.api.services.CredentialQuery2, java.util.List)"><CODE>establish(CredentialQuery2, java.util.List)</CODE></A> calls.  Agents must only use this method to create new
 connection parameter instances; attempts at providing an agent-implemented version of the connection parameter
 interfaces will cause an IllegalArgumentException to be thrown.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A concrete WindowsCommandShellParameters instance
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="release(com.quest.glue.api.services.WindowsCommandShell)"><!-- --></A><H3>
release</H3>
<PRE>
void <B>release</B>(<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShell.html" title="interface in com.quest.glue.api.services">WindowsCommandShell</A>&nbsp;shell)
             throws java.lang.IllegalStateException</PRE>
<DL>
<DD>Releases the shell connection once it is no longer required. It is safe to pass <code>null</code> in here in cases where the shell was never
 initialized.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>shell</CODE> - The shell connection to release
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalStateException</CODE> - A thread other than this connection's creator called this method</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>Foglight Agent Manager<br/>Developer's Kit</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/quest/glue/api/services/WindowsCommandShellParameters.html" title="interface in com.quest.glue.api.services"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/quest/glue/api/services/WindowsConnectionRefusedException.html" title="class in com.quest.glue.api.services"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/quest/glue/api/services/WindowsCommandShellService.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="WindowsCommandShellService.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<i>&#169; 2013 Quest Software Inc. ALL RIGHTS RESERVED.</i>
</BODY>
</HTML>
