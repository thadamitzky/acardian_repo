<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>4.4. FglAM Simulator Builder</title><link rel="stylesheet" type="text/css" href="stylesheet.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="home" href="index.html" title="The Foglight Agent Manager Developer's Kit"/><link rel="up" href="ch04.html" title="Chapter 4. Agent Tooling"/><link rel="prev" href="ch04s03.html" title="4.3. Agent Definition"/><link rel="next" href="ch04s05.html" title="4.5. Code Generator Tools"/><meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.4. FglAM Simulator Builder</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s03.html"><img src="images/prev.png" alt="Prev"/></a> </td><th width="60%" align="center">Chapter 4. Agent Tooling</th><td width="20%" align="right"> <a accesskey="n" href="ch04s05.html"><img src="images/next.png" alt="Next"/></a></td></tr></table><hr/></div><img align="right" alt="[QUEST Logo]" src="images/quest_logo.gif"/><div class="section" title="4.4. FglAM Simulator Builder"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="simulator"/>4.4. FglAM Simulator Builder</h2></div></div></div><p>
			In FglAM, we have added the ability to generate simulated data for defined
			AgentTypes within a cartridge.
		</p><p>
			You can generate a Simulator-Addon CAR file (for example, 
			<span class="emphasis"><em>Simulator-Addon-5_5_2.car</em></span>) alongside your agent's deployment CAR 
			file. The Simulator-Addon CAR file contains a simulator agent for each agent that is 
			defined within your agent package. You can then deploy those simulator agents on FglAM. 
			When enabled, the simulator agents simulate the data your agent has defined within its 
			<span class="emphasis"><em>topology-types.xml</em></span> file.
		</p><p>
			You can configure each metric to be simulated randomly or within a specific value range 
			(for example, 1 - 100), or to be set to one specific value.
		</p><p>
			You would want to deploy and run simulator agents for the following reasons:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">You can use simulator agents to help populate topology objects on the 
					server in order to facilitate the creation of rules and views for your agent. 
					In order to build WCF views, all the monitored topology objects must be created 
					on the server. If the data that your agent collects contains metrics on resources 
					that are difficult or resource-intensive to collect for during development, a 
					deployed simulator agent provides simple means by which these topology objects can 
					be created.
				</li><li class="listitem">You can configure simulator agents to generate metrics that follow a pattern 
					defined to test various rules declared within your agent definition. By running a 
					simulator agent with a specific metric generator distribution strategy, you can 
					simulate thresholds to trigger alerts on the server.
				</li><li class="listitem">Although it is not a specific requirement for cartridge developers, you can 
					use simulator agents to simulate load on the server easily by having the simulator 
					agents generate numerous agent instances and configuring those agent instances to 
					submit data in large volumes.
			</li></ul></div><p>
		</p><p>
			The FglAM Simulator Builder is an Ant macro-def and is available from a full FglAM install or
			from the tooling redistribution archive.
		</p><p>
			The Simulator Builder parses the provided CAR file and, in most cases, is able to determine
			the correct values from the parameters needed in order to generate the correct simulator
            output. The only change required to build simulator agents is the addition of the 
            <code class="varname">&lt;simulator-sample&gt;</code> element in your agent definition. This is used
            to indicate which of the topology types is the top of the submission tree--specifically,
            which type or types your agent will call <code class="function">.submit()</code> on during regular
            operation. The <code class="varname">&lt;simulator-sample&gt;</code> element replaces
            <code class="varname">&lt;topology-sample&gt;</code> from previous versions of the agent
            definition.             
        </p><p>
			In cases where this fails to return the expected results, you may override any one of the
			parameters when running the Simulator Builder by changing the attributes below.
			</p><div class="table"><a id="d0e3828"/><p class="title"><strong>Table 4.1. DevKit Simulator Cartridge Creator Ant macrodef</strong></p><div class="table-contents"><table summary="DevKit Simulator Cartridge Creator Ant macrodef" border="1"><colgroup><col width="33%"/><col width="33%"/><col width="34%"/></colgroup><thead><tr><th valign="top">Attribute</th><th>Description</th><th>Example</th><th align="center" valign="top">Required</th></tr></thead><tbody><tr><td><span class="emphasis"><em>build.dir</em></span></td><td>Path to your project's build output directory</td><td><span class="emphasis"><em>${build.dir}</em></span></td><td>false</td></tr><tr><td>output</td><td>Path to the tooling output directory</td><td><span class="emphasis"><em>${build.dir}/tooling</em></span></td><td>false</td></tr><tr><td>input</td><td>Path to the <span class="emphasis"><em>simulator.xml</em></span></td><td><span class="emphasis"><em>${output}/simulator/simulator.xml</em></span></td><td>false</td></tr></tbody></table></div></div><p><br class="table-break"/>
		</p><p>
			The following is an example simulator builder config that creates a simulator addon from the OS Cartridge(s).
			</p><pre class="programlisting"><b class="hl-tag" style="color: #3333FF;">&lt;project</b> <span class="hl-attribute" style="color: #993399;">name</span>=<span class="hl-value" style="color: #993300">"Simulator"</span> <span class="hl-attribute" style="color: #993399;">default</span>=<span class="hl-value" style="color: #993300">"dist"</span> <span class="hl-attribute" style="color: #993399;">xmlns:fglam</span>=<span class="hl-value" style="color: #993300">"fglam:/ant/macros"</span><b class="hl-tag" style="color: #3333FF;">&gt;</b>

    <em class="hl-tag" style="color: green">&lt;!-- Set the FglAM DevKithome to the location of your developer
         kit installation --&gt;</em>
    <b class="hl-tag" style="color: #3333FF;">&lt;property</b> <span class="hl-attribute" style="color: #993399;">environment</span>=<span class="hl-value" style="color: #993300">"env"</span><b class="hl-tag" style="color: #3333FF;">/&gt;</b>
    <b class="hl-tag" style="color: #3333FF;">&lt;property</b> <span class="hl-attribute" style="color: #993399;">name</span>=<span class="hl-value" style="color: #993300">"fglam.devkit.home"</span> <span class="hl-attribute" style="color: #993399;">value</span>=<span class="hl-value" style="color: #993300">"${env.FGLAM_DEVKIT_HOME}"</span><b class="hl-tag" style="color: #3333FF;">/&gt;</b>

    <em class="hl-tag" style="color: green">&lt;!-- Import the FglAM Tooling Macro-Defs --&gt;</em>
    <b class="hl-tag" style="color: #3333FF;">&lt;import</b> <span class="hl-attribute" style="color: #993399;">file</span>=<span class="hl-value" style="color: #993300">"${fglam.devkit.home}/buildtools/fglam-ant-macros.xml"</span><b class="hl-tag" style="color: #3333FF;">/&gt;</b>

    <em class="hl-tag" style="color: green">&lt;!-- Set the build directory --&gt;</em>
    <b class="hl-tag" style="color: #3333FF;">&lt;property</b> <span class="hl-attribute" style="color: #993399;">name</span>=<span class="hl-value" style="color: #993300">"build.dir"</span>  <span class="hl-attribute" style="color: #993399;">location</span>=<span class="hl-value" style="color: #993300">"${basedir}/build"</span><b class="hl-tag" style="color: #3333FF;">/&gt;</b>

    <b class="hl-tag" style="color: #3333FF;">&lt;target</b> <span class="hl-attribute" style="color: #993399;">name</span>=<span class="hl-value" style="color: #993300">"dist"</span><b class="hl-tag" style="color: #3333FF;">&gt;</b>
        <b class="hl-tag" style="color: #3333FF;">&lt;mkdir</b> <span class="hl-attribute" style="color: #993399;">dir</span>=<span class="hl-value" style="color: #993300">"${build.dir}"</span><b class="hl-tag" style="color: #3333FF;">/&gt;</b>
    	<em class="hl-tag" style="color: green">&lt;!-- Create a Simulator CAR for this Agent Package --&gt;</em>
		<b class="hl-tag" style="color: #3333FF;">&lt;fglam:dev-kit-simulator/&gt;</b>
    <b class="hl-tag" style="color: #3333FF;">&lt;/target&gt;</b>
<b class="hl-tag" style="color: #3333FF;">&lt;/project&gt;</b></pre><p>
      Running this build file results in the following output:</p><pre class="programlisting">[echo] DevKit Simulator Cartridge Creator
[devkit-simulator] 2010-01-14 14:04:04.262 INFO  [main] com.quest.common.log.DebugLevel - Debug
[devkit-simulator]   level set by -Dquest.debug=1
[devkit-simulator] 2010-01-14 14:04:04.263 WARN  [main] com.quest.common.log.DebugLevel -
[devkit-simulator]   Application running in Debug mode on JVM 1.4 or above, but assertions are not
[devkit-simulator]   enabled. Assertions will be enabled dynamically, but classes already loaded
[devkit-simulator]   will be unaffected. Launch with '-ea' in debug mode.
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   Writing agent.manifest
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   Writing monitoring-policy.xml
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   Writing simulator-agent-definition.xml
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   Creating GAR file: /home/scottb/Development/Forge/FglAM/trunk/build/dist/dev-
[devkit-simulator]   kit/example/build/tooling/simulator/FglAMExample-Simulator-Addon-1_2_0.gar
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   Check /home/scottb/Development/Forge/FglAM/trunk/build/dist/dev-kit/example/b
[devkit-simulator]   uild/tooling/simulator/dist for CAR file.
[devkit-simulator] INFO  [main] com.quest.glue.tools.compiler.simulator.AbstractSimulatorBuilder -
[devkit-simulator]   FglAMExample-Simulator-Addon Complete!</pre><p>
		</p><div class="section" title="4.4.1. Simulator Deployment"><div class="titlepage"><div><div><h3 class="title"><a id="simDeployment"/>4.4.1. Simulator Deployment</h3></div></div></div><p>
				The created Simulator-Addon CAR file should be deployed onto the FMS in tandem 
                with the CAR file from which it was derived. Once both CAR files are deployed and 
                active, you need only to deploy the Simulator-Addon	GAR file to the FglAM host.
			</p></div><div class="section" title="4.4.2. Simulator Agent Instance Creation"><div class="titlepage"><div><div><h3 class="title"><a id="simulator-agent-creation"/>4.4.2. Simulator Agent Instance Creation</h3></div></div></div><p>
				Once the Simulator-Addon GAR file is deployed, create a simulator agent instance 
				the same way you create any other agent instance. You can do this either through 
                the Administration UI or using the <code class="varname">fglcmd</code> command-line scripts.
			</p><p>
				Once a simulator agent instance is created, you can edit its property set
                to configure the number of simulated agent instances that are to be created 
                and the way in which their data simulation is to be distributed.
			</p></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s03.html"><img src="images/prev.png" alt="Prev"/></a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html"><img src="images/up.png" alt="Up"/></a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s05.html"><img src="images/next.png" alt="Next"/></a></td></tr><tr><td width="40%" align="left" valign="top">4.3. Agent Definition </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"/></a></td><td width="40%" align="right" valign="top"> 4.5. Code Generator Tools</td></tr></table></div></body></html>