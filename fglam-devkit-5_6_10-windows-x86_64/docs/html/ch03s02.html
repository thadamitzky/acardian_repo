<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>3.2. LogService</title><link rel="stylesheet" type="text/css" href="stylesheet.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="home" href="index.html" title="The Foglight Agent Manager Developer's Kit"/><link rel="up" href="ch03.html" title="Chapter 3. Agent Services"/><link rel="prev" href="ch03.html" title="Chapter 3. Agent Services"/><link rel="next" href="ch03s03.html" title="3.3. TopologyDataSubmissionService3"/><meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.2. LogService</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03.html"><img src="images/prev.png" alt="Prev"/></a> </td><th width="60%" align="center">Chapter 3. Agent Services</th><td width="20%" align="right"> <a accesskey="n" href="ch03s03.html"><img src="images/next.png" alt="Next"/></a></td></tr></table><hr/></div><img align="right" alt="[QUEST Logo]" src="images/quest_logo.gif"/><div class="section" title="3.2. LogService"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="agentservices-LogService"/>3.2. LogService</h2></div></div></div><p>High quality logging is essential to post-mortem debugging and problem solving.
        Since we do not have access to the customer's machines, a set of detailed logs is crucial.</p><p>FglAM provides a logging service for all agents (both in- and out-of-process) that
        allows them to record anything they want. Output to the console (through stdout or
        stderr) is strongly discouraged and is not allowed for in-process agents. All output
        should come from the logging service.</p><p>
          Agent developers are discouraged from implementing their own logging system. If there is a
          deficiency or problem with the provided logging, rather than trying to develop a workaround, 
          you should bring it to the attention of the FglAM development team so that it can be fixed.
        </p><p>The logging service is fully internationalized, but it is the responsibility of
        agent developers to provide their own localization files as appropriate. Agents are
        not able to control where log messages are written or any of the other metadata about
        logging such as the maximum log size, the log file names, or the log formatting. These are
        controlled by FglAM and are the same for all agents.</p><p>The canonical usage example is:</p><div class="example"><a id="get-logger-for-class"/><p class="title"><strong>Example 3.1. Obtaining a logger for a specific class</strong></p><div class="example-contents"><pre class="programlisting"><strong class="hl-keyword">class</strong> AClass {
  <strong class="hl-keyword">private</strong> <strong class="hl-keyword">final</strong> AgentLog LOG;
  <strong class="hl-keyword">public</strong> AClass(...) {
    LOG = ServiceFactory.getService(LogService.<strong class="hl-keyword">class</strong>)
                        .getLogger(AClass.<strong class="hl-keyword">class</strong>);
  }
}</pre></div></div><br class="example-break"/><p>Do not use a static log variable in your class if there is any
        possibility that the class could be used in more than one instance of an agent.
        All the loggers will be customized to a specific agent when returned by the logging
        service.</p><p>All log messages (except DEBUG, DEBUG2, ignored exceptions, and unexpected errors) must be
           internationalized. This is done by creating a file called <span class="emphasis"><em>LogResources.properties</em></span>
           in the same package as the class for which it holds log messages. The file must conform to
           the Java property file format and must contain both the log text and log level for all
           messages used by all classes in the package. Logging calls are then made using the ID of
           the log message. The logging system is responsible for looking up the actual message
           text and performing all parameter replacements.</p><p>For example, in <span class="emphasis"><em>com/quest/example/example/LogResources.properties</em></span>:</p><pre class="programlisting">
         AClass.aLogKey = Log message with <span class="hl-number">3</span> parameters: {<span class="hl-number">0</span>} {<span class="hl-number">1</span>} {<span class="hl-number">2</span>}
         AClass.aLogKey.level = WARN
         </pre><p>The corresponding usage in <code class="function">com.quest.example.example.AClass</code> would be:</p><pre class="programlisting">AgentLog.log(<strong class="hl-string"><em style="color:red">"aLogKey"</em></strong>, <strong class="hl-keyword">new</strong> Object[]{param0, param1, param2});
  AgentLog.log(<strong class="hl-string"><em style="color:red">"aLogKey"</em></strong>, <strong class="hl-keyword">new</strong> Object[]{param0, param1, param2},
                      (Throwable)someException);</pre><p>DEBUG and DEBUG2 log messages do not need to be internationalized
         and their text can be embedded in the code instead of in the 
         <span class="emphasis"><em>LogResources.properties</em></span> file.</p><p>Log messages at the INFO level or higher, in addition to any log files to which 
         they might be redirected, are written to the console. VERBOSE messages are only written to
         log files. DEBUG and DEBUG2 messages are written to the console
         only when the system property <code class="varname">quest.debug</code> is set to 1 or higher.</p><p>Agents should not need to check the current debug level. Simply
         choose the correct log level for the message and the logging system will ensure that only
         those messages appropriate for the current log level are propagated.</p><p>All exceptions must be logged, even if they are explicitly ignored. The
         <code class="function">AgentLog.ignoreException(String message, Throwable throwable)</code>
         method can be used to ignore an exception.</p><div class="section" title="3.2.1. Agent Log Levels"><div class="titlepage"><div><div><h3 class="title"><a id="logging-levels"/>3.2.1. Agent Log Levels</h3></div></div></div><p>
            In the current implementation, the log level is global and is shared by the FglAM
            core and each agent. Agent-specific log levels may be introduced in a future version
            of the product.
          </p><div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"/></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
              You can use the
              <code class="function">AgentLog.getDebugLevel()</code> method to determine
              the current level of debug logging. A value of zero indicates that there is no debug
              logging for that agent log, while a value of one indicates that only
              <code class="function">AgentLog.debug()</code> and not
              <code class="function">AgentLog.debug2()</code>
              log messages are written. A value of two or higher indicates that both
              <code class="function">AgentLog.debug()</code> and
              <code class="function">AgentLog.debug2()</code>
              log messages are written.
          </td></tr></table></div><p>
            The following log levels are available from the logging service.
          </p><div class="table"><a id="d0e1757"/><p class="title"><strong>Table 3.1. Available Log Levels</strong></p><div class="table-contents"><table summary="Available Log Levels" border="1"><colgroup><col width="50%"/><col width="50%"/></colgroup><thead><tr><th align="left">Level</th><th align="left">Description</th><th align="left">Default Destination</th></tr></thead><tbody><tr><td align="left">FATAL</td><td align="left">
                            An error that prevents further operation of the product.
                            This log level should be used only in the most extreme cases.
                        </td><td align="left">Console, Log Files</td></tr><tr><td align="left">ERROR</td><td align="left">
                            An error that prevents the completion or usage of a specific feature or
                            task. The application as a whole continues to function.
                        </td><td align="left">Console, Log Files</td></tr><tr><td align="left">WARN</td><td align="left">
                           An error or exceptional condition that does not prevent the successful
                           completion of a task or feature, but that should be noted and corrected
                           if possible.
                        </td><td align="left">Console, Log Files</td></tr><tr><td align="left">INFO</td><td align="left">
                           An information message about the state of a task or feature. Often used
                           to record the successful completion of tasks.
                        </td><td align="left">Console, Log Files</td></tr><tr><td align="left">VERBOSE</td><td align="left">
                           A message that might be of interest, but that is not important enough to
                           display on the console. Often used to record configuration settings.
                        </td><td align="left">Log Files</td></tr><tr><td align="left">CONFIG</td><td align="left">
                           A specialized version of the VERBOSE tag designed to record system
                           and application configuration. Use of the VERBOSE tag is recommended
                           instead. Use of this log level requires some knowledge of the internal
                           behavior of the logging system.
                        </td><td align="left">Log Files</td></tr><tr><td align="left">DEBUG</td><td align="left">
                           Debugging messages that are not recorded unless the debug level
                           is one or higher (set using the <code class="varname">quest.debug</code> system property).
                        </td><td align="left">Console (<code class="varname">quest.debug</code> &gt;=1 only), Log Files</td></tr><tr><td align="left">DEBUG2</td><td align="left">
                            Debugging messages that are not recorded unless the debug level
                            is two or higher (set using the <code class="varname">quest.debug</code> system property).
                            Messages logged at DEBUG2 are generally very verbose and intended
                            for very low level debugging information.
                        </td><td align="left">Console (<code class="varname">quest.debug</code> &gt;= 2 only), Log Files</td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" title="3.2.2. Multithreaded Logging and Caching"><div class="titlepage"><div><div><h3 class="title"><a id="logging-multithread"/>3.2.2. Multithreaded Logging and Caching</h3></div></div></div><p>
            The logging service is fully multithread safe and does not require any further 
            synchronization on your part. Even loggers shared between class instances can be 
            used in multiple threads simultaneously.
          </p><p>
            AgentLog instances are cached for you. Each class in each agent has at most one 
            AgentLog allocated to it by the LogServer. All instances of a given class in a 
            given agent share the same AgentLog instance. You should not need to, and are 
            discouraged from, caching AgentLog instances yourself at anything more than 
            the class-plus-instance level, as shown in the preceding examples.
          </p></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03.html"><img src="images/prev.png" alt="Prev"/></a> </td><td width="20%" align="center"><a accesskey="u" href="ch03.html"><img src="images/up.png" alt="Up"/></a></td><td width="40%" align="right"> <a accesskey="n" href="ch03s03.html"><img src="images/next.png" alt="Next"/></a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 3. Agent Services </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"/></a></td><td width="40%" align="right" valign="top"> 3.3. TopologyDataSubmissionService3</td></tr></table></div></body></html>